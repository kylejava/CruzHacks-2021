<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <link rel="stylesheet"href="{{ url_for('static', filename='stylesheets/jar.css') }}">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1" crossorigin="anonymous">
    <title>Note.ify</title>
  </head>
  <body style="background-color: #8a9ea7;">
    <div class="container">
      <header class="blog-header py-3">
        <div class="row flex-nowrap justify-content-between align-items-center">
          <div class="col-2 pt-1">
            <a class="navbar-item" href="/">Home</a>
          </div>
          <div class="col-2 pt-1">
            <a class="navbar-item" href="/signin">Sign In</a>
          </div>
          <div class="col-4 text-center">
            <a class="navbar-header" href="/">Noteify</a>
          </div>
          <div class="col-2 d-flex justify-content-end align-items-center">
            <a class="navbar-item" href="/">About</a>
          </div>
          <div class="col-2 d-flex justify-content-end align-items-center">
            <a class="navbar-item" href="/">Contact Us</a>
          </div>
        </div>
      </header>
      <hr>
    </div>
    <div class="rectangle">
      <div class="container">
        <p id="note"></p>
      </div>
    </div>

    <!-- Add These To all HTMl Files -->
    <script src="https://www.gstatic.com/firebasejs/8.2.3/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.2.3/firebase-analytics.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.2.3/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.2.3/firebase-database.js"></script>
    <script src="../static/firebase.js"></script>
    <script src="../static/signin.js"></script>
    <script type="text/javascript">
      function getRandomInt(max) {
          return Math.floor(Math.random() * Math.floor(max));
        }
      var database = firebase.database();
      firebase.auth().onAuthStateChanged(function(user) {
        if (user) {
          console.log(user);
          console.log(user.uid);
          var notes = [];
          var leadsRef = database.ref('/users' + '/' + user.uid+ '/OpenWhenYoureGoingThroughARoughPatch');
          leadsRef.on('value', function(snapshot) {
              snapshot.forEach(function(childSnapshot) {
                var childData = childSnapshot.val();

                var note = (childData['entry']);
                notes.push(note);

              });
              console.log(notes.length);
              if(notes.length == 0){
                document.getElementById('note').innerHTML = "There are no notes in this jar."
              }
              else{
                document.getElementById('note').innerHTML = notes[getRandomInt(notes.length)];
              }
          });
        } else {
          location.href = '/signin';
        }
      });
    </script>
  </body>
</html>
